{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "customer",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(output(\n\t\tfirst_name as string,\n\t\tmiddle_name as string,\n\t\tlast_name as string,\n\t\tSSN as string,\n\t\tapt_no as string,\n\t\tstreet_name as string,\n\t\tcust_city as string,\n\t\tcust_state as string,\n\t\tcust_country as string,\n\t\tcust_zip as string,\n\t\tcust_phone as string,\n\t\tcust_email as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> source2\nsource1 derive(street_name = concat(apt_no,',', street_name),\n\t\tfirst_name = upper(left(first_name,1))+lower(right(first_name,length(first_name)-1)),\n\t\tmiddle_name = lower(middle_name),\n\t\tlast_name = upper(left(last_name,1))+lower(right(last_name,length(last_name)-1)),\n\t\tcust_phone = substring(cust_phone, 1, 3)+'-'+substring(cust_phone, 4, 3)+'-'+substring(cust_phone, 7, 4),\n\t\tcust_id = '0'+SSN) ~> DerivedColumn1\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCUST_ID as integer,\n\t\tCUST_F_NAME as string,\n\t\tCUST_M_NAME as string,\n\t\tCUST_L_NAME as string,\n\t\tCUST_SSN as integer,\n\t\tCUST_STREET as string,\n\t\tCUST_CITY as string,\n\t\tCUST_STATE as string,\n\t\tCUST_COUNTRY as string,\n\t\tCUST_ZIP as integer,\n\t\tCUST_PHONE as string,\n\t\tCUST_EMAIL as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tCUST_ID = cust_id,\n\t\tCUST_F_NAME = first_name,\n\t\tCUST_M_NAME = middle_name,\n\t\tCUST_L_NAME = last_name,\n\t\tCUST_SSN = SSN,\n\t\tCUST_STREET = street_name,\n\t\tCUST_CITY = cust_city,\n\t\tCUST_STATE = cust_state,\n\t\tCUST_COUNTRY = cust_country,\n\t\tCUST_ZIP = cust_zip,\n\t\tCUST_PHONE = cust_phone,\n\t\tCUST_EMAIL = cust_email\n\t)) ~> sink1"
		}
	}
}